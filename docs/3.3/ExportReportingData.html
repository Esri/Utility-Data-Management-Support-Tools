<?xml version="1.0"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xmlns:gmd="http://www.isotc211.org/2005/gmd" xmlns:res="http://www.esri.com/metadata/res/">
  <head>
    <meta http-equiv="content-type" content="text/html; charset=UTF-8" />
    <style xmlns="" xmlns:esri="http://www.esri.com/metadata/" xmlns:msxsl="http://exslt.org/common" type="text/css" id="internalStyle">
    body {
      font-family: "Segoe UI", Arial, Sans-serif;
      font-size: 10pt;
      color: #4C4C4C;
      background-color: #FFFFFF;
      margin: 6px, 6px, 6px, 6px;
    }
    h1 {
      font-family: "Segoe UI Light", "Segoe UI", Arial, Sans-serif;
      font-size: 14pt;
      color: #0079C1;
      margin: 0px 0px 8px 0px;
    }
    h3 {
      font-family: "Segoe UI semibold", "Segoe UI", Arial, Sans-serif;
      font-size: 12pt;
      margin: 10px 0px 4px 0px;
    }
    span.ContentHeader {
      font-family: "Segoe UI semibold", "Segoe UI", Arial, Sans-serif;
      font-size: 12pt;
    }
    span.SubContentHeader {
      font-family: "Segoe UI", Arial, Sans-serif;
      font-size: 10pt;
      color: #6D6C70;
    }
    span.ElementLabel {
      font-family: "Segoe UI", Arial, Sans-serif;
      font-size: 10pt;
      color: #929497;
    }
    div {
      margin: 0px 0px 0px 0px;
    }
    p {
      margin: 0px 0px 6px 0px;
    }
    .center {
      text-align: center;
    }
    img {
      margin: 8px 0px 8px 0px;
    }
    img.summary {
      width: 210px;
      height: 133px;
      margin: 8px 0px 8px 0px;
    }
    img.center {
      text-align: center;
      display: block;
    }
    img.gp {
      width: auto;
    }
    .noThumbnail {
      #color: rgb(70%, 70%, 70%);
      color: #A6A8AB;
      border-width: 1px;
      border-style: solid;
      #color: rgb(70%, 70%, 70%);
      border-color: #A6A8AB;
      padding: 3em 3em;
      position: relative;
      text-align: center;
      width: 210px;
      height: 140px;
      margin: 8px 0px 8px 0px;
    }
    .noContent {
      #color: rgb(70%, 70%, 70%);
      color: #A6A8AB;
    }
    h3 a.expander:link {
      color: #4C4C4C;
      font-weight: normal;
      text-decoration: none;
    }
    h3 a.expander:visited {
      color: #0079C1;
      text-decoration: none;
    }
    h3 a.expander:link:hover, h3 a.expander:visited:hover {
      color: #0079C1;
      text-decoration: none;
    }
    a.expander:link {
      color: #323232;
      font-weight: normal;
      text-decoration: none;
    }
    a.expander:visited {
      color: #0079C1;
      text-decoration: none;
    }
    a.expander:link:hover, a.expander:visited:hover {
      color: #0079C1;
      text-decoration: none;
    }
    a:link {
      color: #5A9359;
      font-weight: normal;
      text-decoration: none;
    }
    a:visited {
      color: #5A9359;
      text-decoration: none;
    }
    a:link:hover, a:visited:hover {
      color: #257824;
      text-decoration: underline;
    }
    div.hide {
      display: none;
      margin: 0px 0px 20px 0px;
      color: #6D6C70;
    }
    div.show {
      display: block;
      margin: 0px 0px 20px 0px;
    }
    span.hide {
      display: none;
      font-family: Times;
    }
    span.show {
      display: inline-block;
      font-style: normal;
      font-family: Times;
    }
    table {
      margin: 0px 0px 0px 0px;
      padding: 0px 0px 8px 0px;
      border-collapse:collapse;
      font-size: 10pt;
    }
    th {
      font-family: "Segoe UI Semibold", Arial, Sans-serif;
      color: #4C4C4C;
      /* color: #6C6D70 for dialog/python reference heading; */
      text-align: left;
      vertical-align: bottom;
      border-bottom: 1px solid #4C4C4C;
    }
    td {
      text-align: left;
      vertical-align: top;
    }
    td.description {
      vertical-align: center;
    }
    td.gp {
      padding: 8px 8px 8px 8px;
      border-bottom: 1px solid #4C4C4C;
    }
    ul {
      margin: 0px 0px 0px 10px;
      padding: 0px 0px 0px 10px;
    }
    li {
      margin: 0px 0px 0px 0px;
      padding: 0px 0px 0px 10px;
    }
    ul ul {
      list-style-type: square;
    }
    pre.wrap {
      width: 99%;
      font-family: "Segoe UI", Arial, Sans-serif;
      font-size: 10pt;
      margin: 0px 0px 0px 0px;
      white-space: pre-wrap;       /* css-3 */
      white-space: -moz-pre-wrap;  /* Mozilla, since 1999 */
      white-space: -pre-wrap;      /* Opera 4-6 */
      white-space: -o-pre-wrap;    /* Opera 7 */
      word-wrap: break-word;       /* Internet Explorer 5.5+ */
    }
    pre.wrap p {
      padding-bottom: 1em;
    }
    pre.wrap li {
      padding-bottom: 1em;
    }
    pre.wrap br {
      display: block;
    }
    pre.gp {
      font-family: Courier New, Courier, monospace;
    }
    .gpcode {
      border: 1px dashed #ACC6D8;
      padding: 10px;
      background-color:#EEEEEE;
      height: auto;
      overflow: scroll; 
      width: 98%;
    }
    .code {
      font-family: monospace;
    }

    p.gp {
      margin: 7px 0px 7px 0px;
    }
    dl {
      margin: 0px 0px 0px 0px;
    }
    dt {
      margin: 0px 0px 0px 15px;
      clear: left;
    }
    dd {
      margin: 0px 0px 0px 15px;
      clear: left;
    }
  </style>
    <style>.highlight .hll { background-color: #ffffcc }
.highlight { background: #f8f8f8; }
.highlight .c { color: #3D7B7B; font-style: italic } /* Comment */
.highlight .err { border: 1px solid #FF0000 } /* Error */
.highlight .k { color: #008000; font-weight: bold } /* Keyword */
.highlight .o { color: #666666 } /* Operator */
.highlight .ch { color: #3D7B7B; font-style: italic } /* Comment.Hashbang */
.highlight .cm { color: #3D7B7B; font-style: italic } /* Comment.Multiline */
.highlight .cp { color: #9C6500 } /* Comment.Preproc */
.highlight .cpf { color: #3D7B7B; font-style: italic } /* Comment.PreprocFile */
.highlight .c1 { color: #3D7B7B; font-style: italic } /* Comment.Single */
.highlight .cs { color: #3D7B7B; font-style: italic } /* Comment.Special */
.highlight .gd { color: #A00000 } /* Generic.Deleted */
.highlight .ge { font-style: italic } /* Generic.Emph */
.highlight .ges { font-weight: bold; font-style: italic } /* Generic.EmphStrong */
.highlight .gr { color: #E40000 } /* Generic.Error */
.highlight .gh { color: #000080; font-weight: bold } /* Generic.Heading */
.highlight .gi { color: #008400 } /* Generic.Inserted */
.highlight .go { color: #717171 } /* Generic.Output */
.highlight .gp { color: #000080; font-weight: bold } /* Generic.Prompt */
.highlight .gs { font-weight: bold } /* Generic.Strong */
.highlight .gu { color: #800080; font-weight: bold } /* Generic.Subheading */
.highlight .gt { color: #0044DD } /* Generic.Traceback */
.highlight .kc { color: #008000; font-weight: bold } /* Keyword.Constant */
.highlight .kd { color: #008000; font-weight: bold } /* Keyword.Declaration */
.highlight .kn { color: #008000; font-weight: bold } /* Keyword.Namespace */
.highlight .kp { color: #008000 } /* Keyword.Pseudo */
.highlight .kr { color: #008000; font-weight: bold } /* Keyword.Reserved */
.highlight .kt { color: #B00040 } /* Keyword.Type */
.highlight .m { color: #666666 } /* Literal.Number */
.highlight .s { color: #BA2121 } /* Literal.String */
.highlight .na { color: #687822 } /* Name.Attribute */
.highlight .nb { color: #008000 } /* Name.Builtin */
.highlight .nc { color: #0000FF; font-weight: bold } /* Name.Class */
.highlight .no { color: #880000 } /* Name.Constant */
.highlight .nd { color: #AA22FF } /* Name.Decorator */
.highlight .ni { color: #717171; font-weight: bold } /* Name.Entity */
.highlight .ne { color: #CB3F38; font-weight: bold } /* Name.Exception */
.highlight .nf { color: #0000FF } /* Name.Function */
.highlight .nl { color: #767600 } /* Name.Label */
.highlight .nn { color: #0000FF; font-weight: bold } /* Name.Namespace */
.highlight .nt { color: #008000; font-weight: bold } /* Name.Tag */
.highlight .nv { color: #19177C } /* Name.Variable */
.highlight .ow { color: #AA22FF; font-weight: bold } /* Operator.Word */
.highlight .w { color: #bbbbbb } /* Text.Whitespace */
.highlight .mb { color: #666666 } /* Literal.Number.Bin */
.highlight .mf { color: #666666 } /* Literal.Number.Float */
.highlight .mh { color: #666666 } /* Literal.Number.Hex */
.highlight .mi { color: #666666 } /* Literal.Number.Integer */
.highlight .mo { color: #666666 } /* Literal.Number.Oct */
.highlight .sa { color: #BA2121 } /* Literal.String.Affix */
.highlight .sb { color: #BA2121 } /* Literal.String.Backtick */
.highlight .sc { color: #BA2121 } /* Literal.String.Char */
.highlight .dl { color: #BA2121 } /* Literal.String.Delimiter */
.highlight .sd { color: #BA2121; font-style: italic } /* Literal.String.Doc */
.highlight .s2 { color: #BA2121 } /* Literal.String.Double */
.highlight .se { color: #AA5D1F; font-weight: bold } /* Literal.String.Escape */
.highlight .sh { color: #BA2121 } /* Literal.String.Heredoc */
.highlight .si { color: #A45A77; font-weight: bold } /* Literal.String.Interpol */
.highlight .sx { color: #008000 } /* Literal.String.Other */
.highlight .sr { color: #A45A77 } /* Literal.String.Regex */
.highlight .s1 { color: #BA2121 } /* Literal.String.Single */
.highlight .ss { color: #19177C } /* Literal.String.Symbol */
.highlight .bp { color: #008000 } /* Name.Builtin.Pseudo */
.highlight .fm { color: #0000FF } /* Name.Function.Magic */
.highlight .vc { color: #19177C } /* Name.Variable.Class */
.highlight .vg { color: #19177C } /* Name.Variable.Global */
.highlight .vi { color: #19177C } /* Name.Variable.Instance */
.highlight .vm { color: #19177C } /* Name.Variable.Magic */
.highlight .il { color: #666666 } /* Literal.Number.Integer.Long */</style>
  </head>
  <body oncontextmenu="return true">
    <h1 xmlns="" xmlns:esri="http://www.esri.com/metadata/" xmlns:msxsl="http://exslt.org/common">ExportReportingData</h1>
    <p xmlns=""><span class="ContentHeader">Title</span>â€ƒ
				Export Reporting Data</p>
    <div xmlns="" xmlns:esri="http://www.esri.com/metadata/" xmlns:msxsl="http://exslt.org/common">
      <h3>Description</h3>
      <p>
        <pre class="wrap">Exports tables with domain descriptions to an output geodatabase.</pre>
      </p>
    </div>
    <div xmlns="">
      <h3>Usage</h3>
      <p>
        <pre class="wrap">
          <span>
- For optimal read performance, a database connection is recommended.

- For optimal write performance, a mobile geodatabase (sqlite) is recommended for the Output Geodatabase.

- File geodatabases only support a subset of views.

- If you specify the utility network controller dataset, association and controller views will only be created to the input datasets if the target dataset name matches the class name in the source utility network.

- You can target the same target dataset with multiple Input Datasets. This allows you to specify the layers with definition queries or subtype group layers for the Input Datasets and load their records to a single target dataset.

- If the length of the view name exceeds the table name limit, the subtype description will be replaced with its code.

- When exporting query layers (e.g., the <a href="https://pro.arcgis.com/en/pro-app/latest/help/data/geodatabases/overview/work-with-the-archive-class.htm">archive class</a>), domain descriptions will only be populated if the <b>Target Dataset Name</b> matches the source data table name.

<h3>License</h3>Basic</span>
        </pre>
      </p>
    </div>
    <div xmlns="">
      <h3>Syntax</h3>
      <p>ExportReportingData (output_gdb, {datasets}, {output_options}, {controller_dataset}, {field_override}) <br xmlns:esri="http://www.esri.com/metadata/" xmlns:msxsl="http://exslt.org/common" /><br xmlns:esri="http://www.esri.com/metadata/" xmlns:msxsl="http://exslt.org/common" /></p>
      <table xmlns:esri="http://www.esri.com/metadata/" xmlns:msxsl="http://exslt.org/common">
        <tr>
          <th width="30%">Parameter</th>
          <th width="50%">Explanation</th>
          <th width="20%">Data Type</th>
        </tr>
        <tr>
          <td class="gp">output_gdb</td>
          <td class="gp" align="left">
            <span class="SubContentHeader">Dialog Reference</span>
            <br />
            <span>
              <p>The output geodatabase where the records will be exported.</p>
            </span>
          </td>
          <td class="gp" align="left">DEWorkspace</td>
        </tr>
        <tr>
          <td class="gp">datasets (Optional) </td>
          <td class="gp" align="left">
            <span class="SubContentHeader">Dialog Reference</span>
            <br />
            <span>
              <p>
The datasets to export.
<ul><li>Input Dataset - the dataset to export. Using a layer in a map can improve performance of the execution of the tool and the validation of geoprocessing while populating the tools parameters. If a layer is specified, only the selected records and the layer's visible fields will be exported.</li><li>Target Dataset Name - the name of the table in the Output Geodatabase. If it doesn't exist, it will be created.</li><li>Include Geometry - For feature classes, this will export the geometry column.</li></ul>
			</p>
            </span>
          </td>
          <td class="gp" align="left">GPValueTable</td>
        </tr>
        <tr>
          <td class="gp">output_options (Optional) </td>
          <td class="gp" align="left">
            <span class="SubContentHeader">Dialog Reference</span>
            <br />
            <span>
              <p>
Various options that control how the output is created.
Create Database Views is only available with an ArcGIS Pro Standard or Advanced license.
<ul><li>Load Records - Load the records into target table.</li><li>Create Database Views - Creates common database views on the exported tables. If the length of the view name exceeds the table name limit, the subtype description will be replaced with its code.</li><li>Truncate Tables - Truncates tables in the Output Geodatabase before loading records.</li><li>Load Associations - When exporting a Utility Network, load the association records.</li><li>Load Subnetwork Controllers - When exporting a Utility Network, load the subnetwork controller records.</li></ul>
			</p>
            </span>
          </td>
          <td class="gp" align="left">GPString</td>
        </tr>
        <tr>
          <td class="gp">controller_dataset (Optional) </td>
          <td class="gp" align="left">
            <span class="SubContentHeader">Dialog Reference</span>
            <br />
            <span>
              <p>The Utility Network. When specified, additional options will be available.</p>
            </span>
          </td>
          <td class="gp" align="left">GPUtilityNetworkLayer</td>
        </tr>
        <tr>
          <td class="gp">field_override (Optional) </td>
          <td class="gp" align="left">
            <span class="SubContentHeader">Dialog Reference</span>
            <br />
            <span>
              <p>
A table defining field names and visibility for the subtype views. This parameter is only applicable when "Create Database Views" is checked.  The Map Layers to CSV tool in the Map toolset can be used to generate a table in this format from a map.
It has the following schema:
<ul><li>Dataset - The name of the target table in the output geodatabase.</li><li>SubtypeCode - The subtype code used in the view definition.</li><li>FieldName - The name of the field in the dataset.</li><li>ViewFieldName - The name of the field as it appears in the view.</li><li>Visible - If the field will be included in view.</li></ul>
			</p>
            </span>
          </td>
          <td class="gp" align="left">GPTableView</td>
        </tr>
      </table>
    </div>
    <div xmlns="">
      <h3>Code Samples</h3>
      <p>
        <span class="span.SubContentHeader">ExportReportingData example 1 (stand-alone script)</span>
        <br />
      </p>
      <p>
        <pre class="wrap">Exports all the classes from a Utility Network in parallel.</pre>
      </p>
      <div class="highlight">
        <pre><span></span><span class="kn">import</span> <span class="nn">datetime</span>
<span class="kn">import</span> <span class="nn">multiprocessing</span>
<span class="kn">import</span> <span class="nn">os</span>

<span class="kn">import</span> <span class="nn">arcpy</span>

<span class="n">utility_network</span> <span class="o">=</span> <span class="s2">"D:/data/un.sde/UtilityNetwork/Network"</span>
<span class="n">reporting</span> <span class="o">=</span> <span class="s2">"D:/data/reporting.sde"</span>
<span class="n">include_geometry</span> <span class="o">=</span> <span class="kc">False</span>
<span class="n">schema_options</span> <span class="o">=</span> <span class="p">[</span>
    <span class="s2">"CREATE_VIEWS"</span><span class="p">,</span>
<span class="p">]</span>
<span class="n">data_options</span> <span class="o">=</span> <span class="p">[</span>
    <span class="s2">"LOAD_RECORDS"</span><span class="p">,</span>
    <span class="s2">"TRUNCATE_TABLES"</span><span class="p">,</span>
<span class="p">]</span>
<span class="n">un_options</span> <span class="o">=</span> <span class="p">[</span>
    <span class="s2">"UN_ASSOCIATIONS"</span><span class="p">,</span>
    <span class="s2">"UN_CONTROLLERS"</span><span class="p">,</span>
<span class="p">]</span>


<span class="k">def</span> <span class="nf">gather_sources</span><span class="p">():</span>
<span class="w">    </span><span class="sd">"""All the UN sources"""</span>
    <span class="k">for</span> <span class="n">network</span> <span class="ow">in</span> <span class="n">arcpy</span><span class="o">.</span><span class="n">Describe</span><span class="p">(</span><span class="n">utility_network</span><span class="p">)</span><span class="o">.</span><span class="n">domainNetworks</span><span class="p">:</span>
        <span class="k">for</span> <span class="n">source</span> <span class="ow">in</span> <span class="n">network</span><span class="o">.</span><span class="n">junctionSources</span> <span class="o">+</span> <span class="n">network</span><span class="o">.</span><span class="n">edgeSources</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">source</span><span class="o">.</span><span class="n">utilityNetworkFeatureClassUsageType</span> <span class="o">==</span> <span class="s2">"SubnetLine"</span><span class="p">:</span>
                <span class="k">continue</span>
            <span class="k">yield</span> <span class="n">source</span><span class="o">.</span><span class="n">name</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">"."</span><span class="p">)[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>


<span class="k">def</span> <span class="nf">export</span><span class="p">(</span><span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
    <span class="n">arcpy</span><span class="o">.</span><span class="n">udms</span><span class="o">.</span><span class="n">ExportReportingData</span><span class="p">(</span>
        <span class="n">output_gdb</span><span class="o">=</span><span class="n">reporting</span><span class="p">,</span>
        <span class="o">**</span><span class="n">kwargs</span><span class="p">,</span>
    <span class="p">)</span>


<span class="k">def</span> <span class="nf">export_wrapper</span><span class="p">(</span><span class="n">arg</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">export</span><span class="p">(</span><span class="o">**</span><span class="n">arg</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>


<span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s2">"__main__"</span><span class="p">:</span>
    <span class="c1"># (path, output name, geometry)</span>
    <span class="n">gdb</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">dirname</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">dirname</span><span class="p">(</span><span class="n">utility_network</span><span class="p">))</span>
    <span class="n">paths</span> <span class="o">=</span> <span class="p">[(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">gdb</span><span class="p">,</span> <span class="n">s</span><span class="p">),</span> <span class="n">s</span><span class="p">,</span> <span class="n">include_geometry</span><span class="p">)</span> <span class="k">for</span> <span class="n">s</span> <span class="ow">in</span> <span class="n">gather_sources</span><span class="p">()]</span>

    <span class="c1"># Create the necessary schema/views in a first pass. This is suggested when running in parallel.</span>
    <span class="c1"># If the schema is already defined, this step can be skipped.</span>
    <span class="n">export</span><span class="p">(</span><span class="n">datasets</span><span class="o">=</span><span class="n">paths</span><span class="p">,</span> <span class="n">controller_dataset</span><span class="o">=</span><span class="n">utility_network</span><span class="p">,</span> <span class="n">options</span><span class="o">=</span><span class="n">schema_options</span> <span class="o">+</span> <span class="n">un_options</span><span class="p">)</span>

    <span class="c1"># Start Associations/Controllers first since this typically is one of the larger tables.</span>
    <span class="n">work</span> <span class="o">=</span> <span class="p">[[</span><span class="nb">dict</span><span class="p">(</span><span class="n">controller_dataset</span><span class="o">=</span><span class="n">utility_network</span><span class="p">,</span> <span class="n">output_options</span><span class="o">=</span><span class="n">data_options</span> <span class="o">+</span> <span class="n">un_options</span><span class="p">)]]</span>
    <span class="k">for</span> <span class="n">path</span> <span class="ow">in</span> <span class="n">paths</span><span class="p">:</span>
        <span class="n">work</span><span class="o">.</span><span class="n">append</span><span class="p">([</span><span class="nb">dict</span><span class="p">(</span><span class="n">datasets</span><span class="o">=</span><span class="p">[</span><span class="n">path</span><span class="p">],</span> <span class="n">output_options</span><span class="o">=</span><span class="n">data_options</span><span class="p">)])</span>

    <span class="c1"># Spawn 4 subprocesses to divide the work.</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">"Starting"</span><span class="p">,</span> <span class="n">datetime</span><span class="o">.</span><span class="n">datetime</span><span class="o">.</span><span class="n">now</span><span class="p">())</span>
    <span class="k">with</span> <span class="n">multiprocessing</span><span class="o">.</span><span class="n">Pool</span><span class="p">(</span><span class="n">processes</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> <span class="n">maxtasksperchild</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span> <span class="k">as</span> <span class="n">pool</span><span class="p">:</span>
        <span class="n">pool</span><span class="o">.</span><span class="n">map</span><span class="p">(</span><span class="n">export_wrapper</span><span class="p">,</span> <span class="n">work</span><span class="p">,</span> <span class="n">chunksize</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">"Done"</span><span class="p">,</span> <span class="n">datetime</span><span class="o">.</span><span class="n">datetime</span><span class="o">.</span><span class="n">now</span><span class="p">())</span>
</pre>
      </div>
    </div>
  </body>
</html>
